% model1_lstm_tanh.m

% Define LSTM network architecture for Model 1
layers = [
    sequenceInputLayer(size(XTrain, 2))
    lstmLayer(128, 'OutputMode', 'sequence')
    fullyConnectedLayer(256)
    tanhLayer
    fullyConnectedLayer(256)
    tanhLayer
    fullyConnectedLayer(1)
    regressionLayer];

% Training options for Model 1 with batch training, mini-batches, and regularization
options = trainingOptions('adam', ...
    'MaxEpochs', 50, ...
    'MiniBatchSize', 32, ...
    'ValidationData', {XVal', YVal'}, ...
    'ValidationFrequency', 10, ...
    'Plots', 'training-progress', ...
    'ExecutionEnvironment', 'auto', ...
    'LearnRateSchedule', 'piecewise', ...
    'LearnRateDropPeriod', 10, ...
    'LearnRateDropFactor', 0.9, ...
    'Shuffle', 'every-epoch',...
    'L2Regularization', 0.01);

% Train Model 1
net = trainNetwork(XTrain', YTrain', layers, options);

% Save the trained Model 1
save('model1_lstm_tanh.mat', 'net');
